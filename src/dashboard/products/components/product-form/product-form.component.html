<nav class="navbar navbar-light bg-light border border-bottom-0">
    <a class="navbar-brand">{{ exists ? "Update" : "Add" }} Product</a>
</nav>

<div class="list-group" *ngIf="!category && !subCategory">
    <li class="list-group-item"><strong>Please select a Category first</strong></li>
    <a class="list-group-item list-group-item-action list-group-item-light py-1 text-dark"
        *ngFor="let cat of categories" (click)="onCategory(cat._id)">{{cat.name}}</a>
</div>

<div class="list-group" *ngIf="category && !subCategory">
    <li class="list-group-item"><strong>Please select a SubCategory</strong></li>
    <a class="list-group-item list-group-item-action list-group-item-light py-1 text-dark"
        *ngFor="let scat of subCategories?.docs" (click)="onSubCategory(scat._id)">{{scat.name}}</a>
</div>

<div class="list-group" *ngIf="subCategory && !brand">
    <li class="list-group-item"><strong>Please select a Brand</strong></li>
    <a class="list-group-item list-group-item-action list-group-item-light py-1 text-dark" *ngFor="let br of brands"
        (click)="onBrand(br._id)">{{br.name}}</a>
</div>

<form [formGroup]="form" (ngSubmit)="submit()" class="p-3 border" *ngIf="category && subCategory && brand">
    <div class="form-group row">
        <label for="category" class="col-sm-2 col-form-label">Category</label>
        <div class="col-sm-8">
            <label class="form-control" id="category">{{category.name}}</label>
        </div>
        <div class="col-sm-2">
            <button class="btn btn-sm btn-warning" (click)="onCategoryChange()">Change</button>
        </div>
    </div>
    <div class="form-group row">
        <label for="category" class="col-sm-2 col-form-label">Sub Category</label>
        <div class="col-sm-8">
            <label class="form-control" id="category">{{subCategory?.name}}</label>
        </div>
        <div class="col-sm-2">
            <button class="btn btn-sm btn-warning" (click)="onSubCategoryChange()">Change</button>
        </div>
    </div>
    <div class="form-group row">
        <label for="brand" class="col-sm-2 col-form-label">Brand</label>
        <div class="col-sm-8">
            <label class="form-control" id="brand">{{brand.name}}</label>
        </div>
        <div class="col-sm-2">
            <button class="btn btn-sm btn-warning" (click)="onBrandChange()">Change</button>
        </div>
    </div>
    <div class="form-group row">
        <label for="name" class="col-sm-2 col-form-label">Name</label>
        <div class="col-sm-10">
            <input type="name" class="form-control" id="name" formControlName="name" placeholder="Product name" />
            <small class="text-danger" *ngIf="form.controls.name.errors && form.controls.name.touched">
                <div [hidden]="!form.controls['name'].errors.required">
                    Name required
                </div>
                <div [hidden]="!form.controls['name'].errors.minlength">
                    Minimum Length should be 3
                </div>
            </small>
        </div>
    </div>

    <div class="form-group row">
        <label for="description" class="col-sm-2 col-form-label">Description</label>
        <div class="col-sm-10">
            <textarea class="form-control" id="description" formControlName="description" placeholder="Description"
                rows="3"> </textarea>
            <small class="text-danger" *ngIf="form.controls.description.errors && form.controls.description.touched">
                Description required
            </small>
        </div>
    </div>
    <div class="form-group row">
        <label for="priority" class="col-sm-2 col-form-label">Priority</label>
        <div class="col-sm-10">
            <input type="number" class="form-control" id="priority" formControlName="priority" placeholder="Priority" />
            <small class="text-danger" *ngIf="form.controls.priority.errors && form.controls.priority.touched">
                <div [hidden]="!form.controls['priority'].errors.required">
                    Priority required
                </div>
                <div [hidden]="!form.controls['priority'].errors.min">
                    Minimum value should be 0
                </div>
            </small>
        </div>
    </div>

    <div class="form-group row">
        <label for="thumb" class="col-sm-2 col-form-label">Thumb</label>
        <div class="col-sm-10">
            <input type="file" class="form-control" id="thumb" (change)="uploadThumb($event)">
        </div>
    </div>

    <div class="form-group row">
        <label for="image" class="col-sm-2 col-form-label">Image</label>
        <div class="col-sm-10">
            <input type="file" class="form-control" id="image" (change)="uploadFile($event)" multiple>
        </div>
        <small class="text-danger" *ngIf="errorMessage.length > 0">
            {{errorMessage}}
        </small>
    </div>

    <div class="d-flex justify-content-end">
        <button type="submit" class="btn btn-primary  mx-1  " [ngClass]="{
            disabled: form.invalid,
            'btn-warning': exists,
            'btn-success': !exists
          }">
            {{ exists ? "Update" : "Create" }}
        </button>
    </div>
</form>
<button class="btn btn-danger btn-sm mx-1" (click)="onClose()">Close</button>
<button class="btn btn-warning btn-sm mx-1" (click)="onClear()">Clear</button>

<!-- {{form.value | json}} -->
<!-- <p>product-form works!</p> -->